# Gateway VM Environment Configuration - Podman Edition
# Copy this file to .env and customize for your setup
# Keep .env secure (chmod 600) and never commit to version control
# All paths relative to /opt/gateway

# ========================================
# NETWORKING AND DOMAIN CONFIGURATION
# ========================================

# Your primary domain for Cloudflare subdomains
DOMAIN=yourdomain.com

# Tailscale network configuration
TAILNET_NAME=your.tailnet
TAILSCALE_AUTHKEY=tskey-your-auth-key-here
TAILSCALE_INTERFACE=tailscale0

# Internal Podman networks
PODMAN_GATEWAY_NET=172.30.0.0/16
PODMAN_FLARESCALE_NET=172.31.0.0/16

# Timezone for container services
TZ=America/Chicago

# Log configuration
LOG_LEVEL=INFO
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# ========================================
# CLOUDFLARE TUNNEL CONFIGURATION
# ========================================

# Cloudflare account (from dashboard)
CLOUDFLARE_ACCOUNT_ID=your-account-id-here
CLOUDFLARE_ZONE_ID=your-zone-id-here

# Tunnel configuration (create at https://dash.cloudflare.com/argotunnel)
CLOUDFLARE_TUNNEL_ID=your-tunnel-id-here
CLOUDFLARE_TUNNEL_TOKEN=your-tunnel-token-here
CLOUDFLARE_TUNNEL_NAME=homelab-gateway

# API token for DNS management (Zone:DNS:Edit permissions)
CLOUDFLARE_API_TOKEN=your-api-token-here

# Cloudflare credentials path
CLOUDFLARE_CONFIG_PATH=/opt/gateway/cloudflared

# ========================================
# PORTAINER CONFIGURATION
# ========================================

# Portainer admin credentials (CHANGE THESE!)
PORTAINER_ADMIN_USER=admin
PORTAINER_ADMIN_PASSWORD=SecurePortainerPass2024!

# Portainer data persistence
PORTAINER_DATA_PATH=/opt/gateway/portainer

# Enable edge features (optional)
PORTAINER_EDGE_ENABLED=false
PORTAINER_EDGE_KEY=

# ========================================
# NTFY NOTIFICATION SERVER
# ========================================

# ntfy admin access
NTFY_ADMIN_USER=admin
NTFY_ADMIN_PASSWORD=SecureNtfyPass2024!

# Pushover integration for iOS/Android alerts
# Get from https://pushover.net → Your Applications → Create "Homelab Alerts"
PUSHOVER_USER_KEY=uz-your-user-key-here
PUSHOVER_APP_TOKEN=ah-your-app-token-here

# ntfy topic configuration
NTFY_TOPIC_HOMELAB=homelab
NTFY_TOPIC_CRITICAL=homelab-critical
NTFY_TOPIC_WARNING=homelab-warning
NTFY_TOPIC_INFO=homelab-info

# Firebase Cloud Messaging for Android (optional)
NTFY_FIREBASE_ENABLED=false
NTFY_FIREBASE_CREDENTIALS_PATH=/opt/gateway/ntfy/firebase-credentials.json

# ========================================
# TRAEFIK REVERSE PROXY CONFIGURATION
# ========================================

# Dashboard access (change these!)
TRAEFIK_ADMIN_USER=admin
TRAEFIK_ADMIN_PASSWORD=SecureTraefikPass2024!

# Let's Encrypt configuration
LETSENCRYPT_EMAIL=admin@yourdomain.com

# Cloudflare API token for DNS-01 challenge
CLOUDFLARE_DNS_API_TOKEN=your-cloudflare-dns-token-here

# Traefik log configuration
TRAEFIK_LOG_LEVEL=INFO
TRAEFIK_ACCESSLOG=true

# ========================================
# SYSTEM AND MONITORING
# ========================================

# Node Exporter configuration
NODE_EXPORTER_PORT=9100
PROMETHEUS_SCRAPE_INTERVAL=15s

# Service discovery
DISCOVERY_WATCH_INTERVAL=30
DISCOVERY_LOG_LEVEL=INFO

# Security
SECURITY_CONTEXT_USER=1000
SECURITY_CONTEXT_GROUP=1000

# ========================================
# FLARESCALE INTEGRATION (from existing infrastructure)
# ========================================

# Pangolin configuration (from flarescalin)
PANGOLIN_CLIENT_ID=your-pangolin-client-id
PANGOLIN_CLIENT_SECRET=your-pangolin-client-secret

# Gerbil configuration (from flarescalin)
GERBIL_UPSTREAM_SSH=localhost:22
GERBIL_UPSTREAM_HTTPS=traefik:443

# Newt relay configuration
NEWT_CLIENT_ID=your-newt-client-id
NEWT_CLIENT_SECRET=your-newt-client-secret
NEWT_ENDPOINT=pangolin.local:3001

# ========================================
# CERTIFICATE AND SSL
# ========================================

# SSL certificate paths (mounted from host)
SSL_CERT_PATH=/opt/gateway/ssl
SSL_KEY_PATH=/opt/gateway/ssl

# Internal CA (if using self-signed certificates)
INTERNAL_CA_PATH=/opt/gateway/ca/internal-ca.pem

# ========================================
# BACKUP AND PERSISTENCE
# ========================================

# Backup configuration
BACKUP_PATH=/opt/backups/gateway
BACKUP_RETENTION_DAYS=30
BACKUP_ENABLED=true

# Log rotation
LOG_ROTATION_ENABLED=true
LOG_ROTATION_SIZE=10m
LOG_ROTATION_COUNT=5

# ========================================
# PERFORMANCE TUNING
# ========================================

# Podman configuration
PODMAN_MEMORY_LIMIT=2g
PODMAN_CPU_LIMIT=1.0
PODMAN_STORAGE_DRIVER=overlay2

# Traefik worker count (adjust based on CPU cores)
TRAEFIK_WORKER_COUNT=2

# ntfy cache settings
NTFY_CACHE_DURATION=12h
NTFY_MAX_FILE_SIZE=25MB
NTFY_ATTACHMENT_CACHE_SIZE=1g

# Portainer resource limits
PORTAINER_MEMORY_LIMIT=512m
PORTAINER_CPU_LIMIT=0.5

# ========================================
# ALERTING THRESHOLDS
# ========================================

# Resource monitoring thresholds (for ntfy alerts)
CPU_THRESHOLD_WARNING=80
CPU_THRESHOLD_CRITICAL=90
MEMORY_THRESHOLD_WARNING=85
MEMORY_THRESHOLD_CRITICAL=95
DISK_THRESHOLD_WARNING=85
DISK_THRESHOLD_CRITICAL=95

# Service health check intervals
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3

# ========================================
# INTEGRATION WITH OLARES (k3s)
# ========================================

# Olares k3s integration
K3S_ENDPOINT=olares-01.tailnet.ts.net:6443
K3S_NAMESPACE=homelab
K3S_TOKEN=k3s-cluster-token

# Prometheus integration
PROMETHEUS_PUSHGATEWAY=olares-01.tailnet.ts.net:9091
PROMETHEUS_SCRAPE_PORT=9100

# ========================================
# DEVELOPMENT AND TESTING
# ========================================

# Enable debug mode (set to true for troubleshooting)
DEBUG_MODE=false

# Test configuration (set to true to validate setup)
VALIDATE_CONFIG=true

# Dry run mode for deployments
DRY_RUN=false

# ========================================
# CUSTOM CONFIGURATION
# ========================================

# Custom domain for internal services (optional)
INTERNAL_DOMAIN=local

# Enable IPv6 (set to true if your network supports it)
ENABLE_IPV6=false

# Custom NTP servers (for time sync)
NTP_SERVERS=time.cloudflare.com,time.google.com,pool.ntp.org

# SELinux mode (permissive for development, enforcing for production)
SELINUX_MODE=permissive

# Firewall configuration
UFW_ENABLED=true
UFW_LOG_LEVEL=medium

# Note: All secrets should be stored in a secure vault or secret manager
# This .env file should never be committed to version control
# Use Podman secrets or external secret management for production